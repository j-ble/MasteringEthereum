// SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

import {Test, console} from "../../lib/forge-std/src/Test.sol";
import {DeployMoodNft} from "../../script/DeployMoodNft.s.sol";
import {MoodNft} from "../../src/MoodNft.sol";

contract DeployMoodTest is Test {
    DeployMoodNft public deployer;

    function setUp() public {
        deployer = new DeployMoodNft();
    }

    function testConvertSvgToImageUri() public view {
        string memory expectedUri = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjYwMCIgdmlld0JveD0iMCAwIDYwMCA2MDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6IzFhMWExZDsiPjxkZWZzPjxmaWx0ZXIgaWQ9Imdsb3ciPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIuNSIgcmVzdWx0PSJjb2xvcmVkQmx1ciIvPjxmZU1lcmdlPjxmZU1lcmdlTm9kZSBpbj0iY29sb3JlZEJsdXIiLz48ZmVNZXJnZU5vZGUgaW49IlNvdXJjZUdyYXBoaWMiLz48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIG9wYWNpdHk9IjAuNyI+PHJlY3QgeD0iMTU1IiB5PSIyMzAiIHdpZHRoPSIyODAiIGhlaWdodD0iOTUiIGZpbGw9ImhzbCgxOTUsIDgwJSwgNTUlKSIgdHJhbnNmb3JtPSJyb3RhdGUoLTE1IDI5NSAyNzcuNSkiIC8+PHJlY3QgeD0iNDIwIiB5PSI1MCIgd2lkdGg9IjE1MCIgaGVpZ2h0PSIyMjAiIGZpbGw9ImhzbCgyODAsIDc1JSwgNjAlKSIgdHJhbnNmb3JtPSJyb3RhdGUoMjUgNDk1IDE2MCkiIC8+PHJlY3QgeD0iNTAiIHk9IjQ1MCIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIxMzAiIGZpbGw9ImhzbCgzNDAsIDg1JSwgNjUlKSIgdHJhbnNmb3JtPSJyb3RhdGUoNSAxNTAgNTE1KSIgLz48cmVjdCB4PSIzNTAiIHk9IjM4MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSI3MCIgZmlsbD0iaHNsKDUwLCA5MCUsIDUwJSkiIHRyYW5zZm9ybT0icm90YXRlKC01IDQ3MCA0MTUpIiAvPjwvZz48ZyBmaWx0ZXI9InVybCgjZ2xvdykiPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEyMCIgcj0iNDUiIGZpbGw9ImhzbCgxMCwgODglLCA2MiUpIiBmaWxsLW9wYWNpdHk9IjAuODUiIC8+PGNpcmNsZSBjeD0iNTEwIiBjeT0iMjkwIiByPSI3MCIgZmlsbD0iaHNsKDE0MCwgODAlLCA0NSUpIiBmaWxsLW9wYWNpdHk9IjAuOSIgLz48Y2lyY2xlIGN4PSIyODAiIGN5PSI0ODAiIHI9IjU1IiBmaWxsPSJoc2woMjIwLCA5NSUsIDcwJSkiIGZpbGwtb3BhY2l0eT0iMC45NSIgLz48Y2lyY2xlIGN4PSIyNTAiIGN5PSI4MCIgcj0iMjUiIGZpbGw9ImhzbCgzMTAsIDgyJSwgNzUlKSIgZmlsbC1vcGFjaXR5PSIwLjgiIC8+PGNpcmNsZSBjeD0iNDUwIiBjeT0iNTUwIiByPSIzMCIgZmlsbD0iaHNsKDYwLCA5MCUsIDY1JSkiIGZpbGwtb3BhY2l0eT0iMC45IiAvPjxjaXJjbGUgY3g9IjgwIiB5PSIzNTAiIHI9IjYwIiBmaWxsPSJoc2woMCwgODUlLCA1NSUpIiBmaWxsLW9wYWNpdHk9IjAuOCIgLz48Y2lyY2xlIGN4PSIzOTAiIGN5PSIxNTAiIHI9IjQwIiBmaWxsPSJoc2woMjU1LCA3OCUsIDY4JSkiIGZpbGwtb3BhY2l0eT0iMC45IiAvPjwvZz48ZyBmaWxsLW9wYWNpdHk9IjAuOSIgZmlsbD0iaHNsKDAsIDAlLCA5NSUpIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzIiAvPjxjaXJjbGUgY3g9IjU1MCIgY3k9IjU4MCIgcj0iNCIgLz48Y2lyY2xlIGN4PSIzMDAiIGN5PSIzMDAiIHI9IjIiIC8+PGNpcmNsZSBjeD0iMTIwIiBjeT0iNDkwIiByPSIzIiAvPjxjaXJjbGUgY3g9IjQ4MCIgY3k9IjgwIiByPSI1IiAvPjxjaXJjbGUgY3g9IjIwMCIgY3k9IjIwNSIgcj0iMiIgLz48Y2lyY2xlIGN4PSI0MDAiIGN5PSI0MDAiIHI9IjMiIC8+PC9nPjwvc3ZnPg==";
        string memory svg = '<svg width="600" height="600" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg" style="background-color:#1a1a1d;"><defs><filter id="glow"><feGaussianBlur stdDeviation="2.5" result="coloredBlur"/><feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs><g opacity="0.7"><rect x="155" y="230" width="280" height="95" fill="hsl(195, 80%, 55%)" transform="rotate(-15 295 277.5)" /><rect x="420" y="50" width="150" height="220" fill="hsl(280, 75%, 60%)" transform="rotate(25 495 160)" /><rect x="50" y="450" width="200" height="130" fill="hsl(340, 85%, 65%)" transform="rotate(5 150 515)" /><rect x="350" y="380" width="240" height="70" fill="hsl(50, 90%, 50%)" transform="rotate(-5 470 415)" /></g><g filter="url(#glow)"><circle cx="100" cy="120" r="45" fill="hsl(10, 88%, 62%)" fill-opacity="0.85" /><circle cx="510" cy="290" r="70" fill="hsl(140, 80%, 45%)" fill-opacity="0.9" /><circle cx="280" cy="480" r="55" fill="hsl(220, 95%, 70%)" fill-opacity="0.95" /><circle cx="250" cy="80" r="25" fill="hsl(310, 82%, 75%)" fill-opacity="0.8" /><circle cx="450" cy="550" r="30" fill="hsl(60, 90%, 65%)" fill-opacity="0.9" /><circle cx="80" y="350" r="60" fill="hsl(0, 85%, 55%)" fill-opacity="0.8" /><circle cx="390" cy="150" r="40" fill="hsl(255, 78%, 68%)" fill-opacity="0.9" /></g><g fill-opacity="0.9" fill="hsl(0, 0%, 95%)"><circle cx="50" cy="50" r="3" /><circle cx="550" cy="580" r="4" /><circle cx="300" cy="300" r="2" /><circle cx="120" cy="490" r="3" /><circle cx="480" cy="80" r="5" /><circle cx="200" cy="205" r="2" /><circle cx="400" cy="400" r="3" /></g></svg>';
        string memory actualUri = deployer.svgToImageURI(svg);
        assert(keccak256(abi.encodePacked(expectedUri)) == keccak256(abi.encodePacked(actualUri)));
    }
}